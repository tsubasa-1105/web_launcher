<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Launcher Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' fill='%2306b6d4'%3E%3Crect x='10' y='10' width='35' height='35' rx='8'/%3E%3Crect x='55' y='10' width='35' height='35' rx='8'/%3E%3Crect x='10' y='55' width='35' height='35' rx='8'/%3E%3Crect x='55' y='55' width='35' height='35' rx='8'/%3E%3C/svg%3E">

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Sortable.js CDN (ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ç”¨) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

    <!-- Google Fonts: Inter + JetBrains Mono (ã‚³ãƒ¼ãƒ‰è¡¨ç¤ºç”¨) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <style>
        /* OS ã®ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰è¨­å®šã«è¿½å¾“ */
        :root {
            color-scheme: light dark;
        }

        body {
            font-family: 'Inter', sans-serif;
        }

        .mono-font {
            font-family: 'JetBrains Mono', monospace;
        }

        /* ã‚°ãƒªãƒƒãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³èƒŒæ™¯ */
        .grid-background {
            background-image:
                linear-gradient(rgba(6, 182, 212, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(6, 182, 212, 0.03) 1px, transparent 1px);
            background-size: 24px 24px;
        }

        /* ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ç”¨ */
        .sortable-ghost {
            opacity: 0.5;
            background-color: rgba(6, 182, 212, 0.1);
            border-color: #06b6d4 !important;
        }
        .sortable-chosen {
            cursor: grabbing;
        }

        /* ãƒˆãƒ¼ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .toast-message {
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        .toast-enter {
            opacity: 0;
            transform: translateY(20px);
        }
        .toast-leave {
            opacity: 0;
            transform: translateY(20px);
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼ */
        input[type="color"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            width: 48px;
            height: 48px;
            padding: 0;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            background-color: transparent;
            overflow: hidden;
        }
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0;
        }
        input[type="color"]::-webkit-color-swatch {
            border: 2px solid #cbd5e1;
            border-radius: 12px;
        }
        .dark input[type="color"]::-webkit-color-swatch {
            border-color: #475569;
        }
        input[type="color"]::-moz-color-swatch {
            border: 2px solid #cbd5e1;
            border-radius: 12px;
        }
        .dark input[type="color"]::-moz-color-swatch {
            border-color: #475569;
        }

        /* çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ãƒœã‚¿ãƒ³ */
        .emoji-btn {
            transition: transform 0.1s ease-out, background-color 0.1s;
        }
        .emoji-btn:hover {
            transform: scale(1.15);
            background-color: rgba(6, 182, 212, 0.1);
        }

        /* çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ã®ã‚¿ãƒ– */
        .emoji-tab-btn {
            transition: all 0.15s ease;
        }
        .emoji-tab-btn[aria-selected="true"] {
            background-color: #06b6d4;
            color: white;
            box-shadow: 0 2px 8px rgba(6, 182, 212, 0.3);
        }
        .emoji-tab-btn[aria-selected="false"] {
            background-color: transparent;
            color: #64748b;
        }
        .dark .emoji-tab-btn[aria-selected="false"] {
            color: #94a3b8;
        }

        /* ã‚°ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ãƒ åŠ¹æœ */
        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        .dark .glass-panel {
            background: rgba(15, 23, 42, 0.7);
        }

        /* ã‚«ãƒ¼ãƒ‰ã®ãƒ›ãƒãƒ¼ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .link-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .link-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(6, 182, 212, 0.15);
        }

        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒ  */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹å¼·åŒ– */
        .text-sm, .text-xs, .text-lg {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.5; }
        }
        .loading-ring {
            animation: pulse-ring 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã®ç‚¹æ»… */
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }
        .status-dot {
            animation: blink 2s ease-in-out infinite;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-white to-cyan-50 dark:from-slate-950 dark:via-slate-900 dark:to-cyan-950 text-gray-800 dark:text-gray-200 min-h-screen antialiased transition-colors duration-500 grid-background">

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ -->
    <div class="container mx-auto max-w-6xl p-4 sm:p-6 lg:p-8">

        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
            <div class="flex items-start md:items-center gap-6">
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-cyan-600 via-teal-500 to-indigo-600 dark:from-cyan-400 dark:via-teal-400 dark:to-indigo-400 bg-clip-text text-transparent">
                        Web Launcher
                    </h1>
                    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1 mono-font">
                        <span class="inline-block w-2 h-2 rounded-full bg-green-500 status-dot mr-2"></span>
                        System Operational
                    </p>
                </div>

                <!-- ãƒ‡ã‚¸ã‚¿ãƒ«æ™‚è¨ˆï¼ˆãƒ¢ãƒã‚¤ãƒ«ã§ã‚‚è¡¨ç¤ºï¼‰ -->
                <div class="flex items-center gap-3 px-4 py-2.5 rounded-xl bg-gradient-to-br from-cyan-50 to-teal-50 dark:from-slate-800 dark:to-slate-800 border border-cyan-200/50 dark:border-slate-700 shadow-sm">
                    <span class="mono-font text-xs font-medium text-cyan-600/70 dark:text-cyan-400/60" id="digital-date">01/01</span>
                    <div class="w-px h-5 bg-cyan-200 dark:bg-slate-700 hidden md:block"></div>
                    <div class="flex items-center gap-1.5">
                        <span class="mono-font text-lg font-bold text-cyan-700 dark:text-cyan-400" id="digital-clock-hours">00</span>
                        <span class="mono-font text-xl text-cyan-500/50 dark:text-cyan-400/50">:</span>
                        <span class="mono-font text-lg font-bold text-cyan-700 dark:text-cyan-400" id="digital-clock-minutes">00</span>
                        <span class="mono-font text-xl text-cyan-500/50 dark:text-cyan-400/50 hidden md:block">:</span>
                        <span class="mono-font text-lg font-bold text-cyan-600 dark:text-cyan-300" id="digital-clock-seconds">00</span>
                    </div>
                </div>
            </div>

            <div class="flex items-center gap-3">
                <!-- ç·¨é›†ãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                <div id="edit-mode-actions" class="hidden flex items-center gap-3">
                    <button id="cancel-changes" class="px-4 py-2 rounded-lg bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-cyan-400 transition-all shadow-sm">
                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                    <button id="save-changes" class="px-5 py-2.5 rounded-lg bg-gradient-to-r from-cyan-600 to-teal-600 text-white font-medium hover:from-cyan-500 hover:to-teal-500 focus:outline-none focus:ring-2 focus:ring-cyan-400 shadow-md hover:shadow-lg transition-all">
                        å¤‰æ›´ã‚’ä¿å­˜
                    </button>
                </div>

                <!-- è¨­å®šãƒ¢ãƒ¼ãƒ‰ãƒˆã‚°ãƒ«ãƒœã‚¿ãƒ³ -->
                <button id="toggle-edit-mode" class="flex items-center gap-2 px-5 py-2.5 rounded-lg bg-gradient-to-r from-cyan-600 to-teal-600 text-white font-medium hover:from-cyan-500 hover:to-teal-500 focus:outline-none focus:ring-2 focus:ring-cyan-400 focus:ring-offset-2 dark:focus:ring-offset-slate-900 transition-all shadow-md hover:shadow-lg">
                    <svg id="icon-settings" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0M3.75 18H7.5m3-6h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0M3.75 12H7.5" />
                    </svg>
                    <svg id="icon-close" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 hidden">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    <span id="toggle-edit-text" class="font-semibold">è¨­å®šãƒ¢ãƒ¼ãƒ‰</span>
                </button>
            </div>
        </header>

        <!-- ãƒªãƒ³ã‚¯ä¸€è¦§ -->
        <main>
            <!-- æ–°è¦è¿½åŠ ãƒœã‚¿ãƒ³ï¼ˆè¨­å®šãƒ¢ãƒ¼ãƒ‰æ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
            <div id="add-card-container" class="hidden mb-6">
                <button id="add-new-card-btn" class="w-full py-4 px-6 border-2 border-dashed border-cyan-300 dark:border-cyan-700 rounded-xl text-cyan-600 dark:text-cyan-400 hover:border-cyan-500 hover:bg-cyan-50 dark:hover:bg-cyan-900/20 transition-all flex items-center justify-center gap-3 group">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 group-hover:scale-110 transition-transform">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                    </svg>
                    <span class="font-medium">æ–°ã—ã„ãƒªãƒ³ã‚¯ã‚’è¿½åŠ </span>
                </button>
            </div>

            <!-- ãƒªãƒ³ã‚¯ã‚°ãƒªãƒƒãƒ‰ -->
            <div id="links-container" class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ -->
                <div id="loading-spinner" class="md:col-span-2 text-center py-16">
                    <div class="relative inline-block">
                        <div class="absolute inset-0 rounded-full bg-cyan-400 dark:bg-cyan-600 loading-ring"></div>
                        <svg class="animate-spin h-8 w-8 text-white mx-auto relative z-10" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                    </div>
                    <p class="mt-4 text-gray-500 dark:text-gray-400 mono-font text-sm">ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ä¸­...</p>
                </div>
            </div>

            <!-- ãƒ‡ãƒ¼ã‚¿ãŒç©ºã®å ´åˆã®è¡¨ç¤º -->
            <div id="empty-state" class="hidden text-center py-16 glass-panel rounded-2xl border border-gray-200 dark:border-slate-700">
                <div class="inline-flex items-center justify-center w-20 h-20 rounded-full bg-gradient-to-br from-cyan-100 to-teal-100 dark:from-cyan-900/30 dark:to-teal-900/30 mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 text-cyan-600 dark:text-cyan-400">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244" />
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200">ãƒªãƒ³ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</h3>
                <p class="mt-2 text-sm text-gray-500 dark:text-gray-400 max-w-md mx-auto">ã€Œè¨­å®šãƒ¢ãƒ¼ãƒ‰ã€ã‹ã‚‰æ–°ã—ã„ãƒªãƒ³ã‚¯ã‚’è¿½åŠ ã—ã¦ã€ã‚ãªãŸã®ãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†ã€‚</p>
            </div>
        </main>

        <!-- è¨­å®šãƒ¢ãƒ¼ãƒ‰ UIï¼ˆãƒ’ãƒ³ãƒˆï¼‰ -->
        <footer id="edit-controls" class="hidden mt-6 p-4 glass-panel rounded-xl border border-gray-200 dark:border-slate-700">
            <div class="flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-cyan-500">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z" />
                </svg>
                <span class="mono-font">ãƒ’ãƒ³ãƒˆï¼šã‚«ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ä¸¦ã³æ›¿ãˆã§ãã¾ã™ | è‰²ã¨çµµæ–‡å­—ã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½</span>
            </div>
        </footer>
    </div>

    <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆãƒˆãƒ¼ã‚¹ãƒˆï¼‰ -->
    <div id="toast-container" class="fixed bottom-6 right-6 z-50 space-y-3">
        <!-- JS ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ -->
    </div>

    <!-- çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
    <div id="emoji-picker-modal" class="hidden fixed inset-0 z-40 bg-black/40 dark:bg-black/60 flex items-center justify-center p-4 backdrop-blur-sm" role="dialog" aria-modal="true" aria-labelledby="emoji-picker-title">
        <div id="emoji-picker-content" class="bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-md max-h-[70vh] flex flex-col border border-gray-200 dark:border-slate-700">
            <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã¨æ¤œç´¢ãƒãƒ¼ -->
            <div class="p-4 border-b border-gray-200 dark:border-slate-700">
                <h3 id="emoji-picker-title" class="text-lg font-semibold text-center mb-3 text-gray-800 dark:text-gray-200">çµµæ–‡å­—ã‚’é¸æŠ</h3>
                <input id="emoji-search-input" type="text" placeholder="çµµæ–‡å­—ã‚’æ¤œç´¢ (ä¾‹ï¼šç¬‘é¡”ï¼Œdog, ...)" class="w-full px-4 py-2.5 rounded-lg border-gray-300 dark:border-slate-600 shadow-sm focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 bg-white dark:bg-slate-700 text-gray-900 dark:text-gray-100 mono-font text-sm">
            </div>

            <!-- ã‚«ãƒ†ã‚´ãƒªã‚¿ãƒ– -->
            <div id="emoji-picker-tabs" class="p-3 flex flex-nowrap justify-center gap-2 border-b border-gray-200 dark:border-slate-700 bg-gray-50/50 dark:bg-slate-700/50" role="tablist">
                <!-- JS ã§ã‚¿ãƒ–ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ -->
            </div>

            <!-- çµµæ–‡å­—ã‚°ãƒªãƒƒãƒ‰ -->
            <div id="emoji-picker-grid" class="flex-1 overflow-y-auto p-3 grid grid-cols-7 sm:grid-cols-8 gap-1.5" role="grid">
                <!-- JS ã§çµµæ–‡å­—ãŒæŒ¿å…¥ã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <!-- JS (SPA ãƒ­ã‚¸ãƒƒã‚¯) -->
    <script type="module">
        // SVG ã‚¢ã‚¤ã‚³ãƒ³
        const icons = {
            copy: `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.378h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.08-3.32-7.4-7.4-7.4S4.125 7.17 4.125 11.25v6.075c0 .621.504 1.125 1.125 1.125H6.75v-1.091c0-.67.204-1.3.562-1.841m7.5 0V11.25c0-1.556-1.26-2.816-2.816-2.816M9 11.25v1.5a2.816 2.816 0 002.816 2.816m0 0H12m2.25-4.5v-1.5c0-.67-.204-1.3-.562-1.841m-6.376 0c-.358.54-.562 1.17-.562 1.841v1.5m0 0V11.25c0-1.556 1.26-2.816 2.816-2.816M9 11.25v1.5a2.816 2.816 0 002.816 2.816m0 0H12m2.25-4.5v-1.5c0-.67-.204-1.3-.562-1.841m-6.376 0c-.358.54-.562 1.17-.562 1.841v1.5m0 0V11.25c0-1.556 1.26-2.816 2.816-2.816M9 11.25v1.5a2.816 2.816 0 002.816 2.816m0 0H12" />
                </svg>
            `,
            check: `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-green-500">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                </svg>
            `,
            handle: `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-gray-400 dark:text-gray-500 cursor-move hover:text-cyan-500 transition-color">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 9h16.5m-16.5 6.75h16.5" />
                </svg>
            `,
            delete: `
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.502 0c-.342.052-.682.107-1.022.166m11.48 0A48.067 48.067 0 0012 5.109C8.742 5.109 5.89 5.426 3.27 5.79m14.456 0L12 5.109m0 0L9.26 5.79M12 5.109l.006.007l.006-.007M12 5.109l-.006.007l-.006-.007" />
                </svg>
            `
        };

        // çµµæ–‡å­—ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚«ãƒ†ã‚´ãƒªã¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä»˜ãï¼‰
        const emojiCategories = {
            smileys: "é¡”",
            animals: "å‹•ç‰©",
            travel: "å ´æ‰€",
            food: "é£Ÿã¹ç‰©",
            objects: "ãƒ¢ãƒ",
            symbols: "è¨˜å·",
        };

        const emojiPickerData = [
            // é¡” (Smileys & Emotion)
            { e: "ğŸ˜€", k: ["ç¬‘é¡”", "é¡”", "smile", "face"], c: "smileys" },
            { e: "ğŸ˜ƒ", k: ["å¤§ç¬‘ã„", "happy"], c: "smileys" },
            { e: "ğŸ˜„", k: ["ã«ã“ã‚„ã‹", "laugh"], c: "smileys" },
            { e: "ğŸ˜", k: ["ç¬‘é¡”", "grin"], c: "smileys" },
            { e: "ğŸ˜†", k: ["çˆ†ç¬‘", "laughing"], c: "smileys" },
            { e: "ğŸ˜…", k: ["æ±—", "ã‚ã›", "sweat"], c: "smileys" },
            { e: "ğŸ˜‚", k: ["ç¬‘ã„æ³£ã", "æ¶™", "joy", "tear"], c: "smileys" },
            { e: "ğŸ¤£", k: ["ç¬‘ã„è»¢ã’ã‚‹", "rofl"], c: "smileys" },
            { e: "ğŸ¥²", k: ["å¬‰ã—æ³£ã", "smile", "tear"], c: "smileys" },
            { e: "ğŸ¥¹", k: ["æ„Ÿå‹•", "æ¶™ç›®", "pleading"], c: "smileys" },
            { e: "ğŸ˜Š", k: ["å¾®ç¬‘ã¿", "blush"], c: "smileys" },
            { e: "ğŸ˜‡", k: ["å¤©ä½¿", "angel"], c: "smileys" },
            { e: "ğŸ¥°", k: ["å¤§å¥½ã", "ãƒãƒ¼ãƒˆ", "love", "cute"], c: "smileys" },
            { e: "ğŸ˜", k: ["ãƒãƒ¼ãƒˆç›®", "love", "heart eyes"], c: "smileys" },
            { e: "ğŸ¤©", k: ["ã‚¹ã‚¿ãƒ¼", "ãã‚‰ãã‚‰", "star"], c: "smileys" },
            { e: "ğŸ˜˜", k: ["ã‚­ã‚¹", "kiss"], c: "smileys" },
            { e: "ğŸ˜‹", k: ["ãŠã„ã—ã„", "ãƒšãƒ­", "yummy"], c: "smileys" },
            { e: "ğŸ˜›", k: ["èˆŒå‡ºã—", "tongue"], c: "smileys" },
            { e: "ğŸ˜œ", k: ["ã‚¦ã‚¤ãƒ³ã‚¯", "wink"], c: "smileys" },
            { e: "ğŸ¤ª", k: ["å¤‰é¡”", "crazy"], c: "smileys" },
            { e: "ğŸ¤¨", k: ["ç–‘ã„", "suspect"], c: "smileys" },
            { e: "ğŸ§", k: ["ãƒ¢ãƒã‚¯ãƒ«", "analyze"], c: "smileys" },
            { e: "ğŸ¤“", k: ["ãƒ¡ã‚¬ãƒ", "nerd"], c: "smileys" },
            { e: "ğŸ˜", k: ["ã‚µãƒ³ã‚°ãƒ©ã‚¹", "cool"], c: "smileys" },
            { e: "ğŸ¥¸", k: ["å¤‰è£…", "disguise"], c: "smileys" },
            { e: "ğŸ¥³", k: ["ãƒ‘ãƒ¼ãƒ†ã‚£", "ãŠç¥ã„", "party"], c: "smileys" },
            { e: "ğŸ¤¯", k: ["çˆ†ç™º", "ã³ã£ãã‚Š", "mind blown"], c: "smileys" },
            { e: "ğŸ˜³", k: ["ç…§ã‚Œã‚‹", "èµ¤é¢", "flushed"], c: "smileys" },
            { e: "ğŸ¥º", k: ["ãŠé¡˜ã„", "ã†ã‚‹ã†ã‚‹", "please"], c: "smileys" },
            { e: "ğŸ« ", k: ["æº¶ã‘ã‚‹", "ã¨ã‘ã‚‹", "melting"], c: "smileys" },
            { e: "ğŸ«¢", k: ["ã‚ã£", "æ‰‹", "omg"], c: "smileys" },
            { e: "ğŸ«£", k: ["è¦—ãè¦‹", "peek"], c: "smileys" },
            { e: "ğŸ¤”", k: ["è€ƒãˆä¸­", "think"], c: "smileys" },
            { e: "ğŸ¤«", k: ["ã—ãƒ¼", "quiet"], c: "smileys" },
            { e: "ğŸ¤", k: ["ã‚¸ãƒƒãƒ‘ãƒ¼", "zip"], c: "smileys" },
            { e: "ğŸ˜", k: ["çœŸé¡”", "neutral"], c: "smileys" },
            { e: "ğŸ˜‘", k: ["ç„¡è¡¨æƒ…", "expressionless"], c: "smileys" },
            { e: "ğŸ˜¶", k: ["ç„¡è¨€", "no mouth"], c: "smileys" },
            { e: "ğŸ˜®", k: ["ãŠã©ã‚ã", "surprised"], c: "smileys" },
            { e: "ğŸ¤¤", k: ["ã‚ˆã ã‚Œ", "drooling"], c: "smileys" },
            { e: "ğŸ˜´", k: ["çœ ã„", "sleep"], c: "smileys" },
            { e: "ğŸ¥±", k: ["ã‚ãã³", "yawn"], c: "smileys" },
            { e: "ğŸ˜ª", k: ["çœ ã„", "sleepy"], c: "smileys" },
            { e: "ğŸ˜µ", k: ["ã‚ã¾ã„", "dizzy"], c: "smileys" },
            { e: "ğŸ¤¢", k: ["åãæ°—", "nauseated"], c: "smileys" },
            { e: "ğŸ¤§", k: ["ãã—ã‚ƒã¿", "sneeze"], c: "smileys" },
            { e: "ğŸ˜·", k: ["ãƒã‚¹ã‚¯", "mask"], c: "smileys" },
            { e: "ğŸ¤’", k: ["ç†±", "fever"], c: "smileys" },
            { e: "ğŸ¤•", k: ["æ€ªæˆ‘", "bandage"], c: "smileys" },
            { e: "ğŸ˜¥", k: ["æ‚²ã—ã„", "sad", "disappointed"], c: "smileys" },
            { e: "ğŸ˜­", k: ["æ³£ã", "å·æ³£", "cry", "sad"], c: "smileys" },
            { e: "ğŸ˜±", k: ["ææ€–", "scream"], c: "smileys" },
            { e: "ğŸ˜¡", k: ["æ€’ã‚Š", "angry", "rage"], c: "smileys" },
            { e: "ğŸ˜ ", k: ["æ€’", "mad"], c: "smileys" },
            { e: "ğŸ˜ˆ", k: ["æ‚ªé­”", "devil"], c: "smileys" },
            { e: "ğŸ‘»", k: ["ãŠã°ã‘", "ghost"], c: "smileys" },
            { e: "ğŸƒ", k: ["ã‹ã¼ã¡ã‚ƒ", "halloween"], c: "smileys" },
            { e: "ğŸ˜º", k: ["çŒ«", "ç¬‘é¡”", "cat smile"], c: "smileys" },
            { e: "ğŸ˜»", k: ["çŒ«", "ãƒãƒ¼ãƒˆ", "cat heart"], c: "smileys" },
            { e: "ğŸ˜¿", k: ["çŒ«", "æ³£ã", "cat cry"], c: "smileys" },

            // å‹•ç‰©ãƒ»è‡ªç„¶ (Animals & Nature)
            { e: "ğŸ¶", k: ["çŠ¬", "dog"], c: "animals" },
            { e: "ğŸ±", k: ["çŒ«", "cat"], c: "animals" },
            { e: "ğŸ­", k: ["ãƒã‚ºãƒŸ", "mouse"], c: "animals" },
            { e: "ğŸ¹", k: ["ãƒãƒ ã‚¹ã‚¿ãƒ¼", "hamster"], c: "animals" },
            { e: "ğŸ°", k: ["ã‚¦ã‚µã‚®", "rabbit"], c: "animals" },
            { e: "ğŸ¦Š", k: ["ã‚­ãƒ„ãƒ", "fox"], c: "animals" },
            { e: "ğŸ»", k: ["ç†Š", "bear"], c: "animals" },
            { e: "ğŸ¼", k: ["ãƒ‘ãƒ³ãƒ€", "panda"], c: "animals" },
            { e: "ğŸ»â€â„ï¸", k: ["ã‚·ãƒ­ã‚¯ãƒ", "polar bear"], c: "animals" },
            { e: "ğŸ¨", k: ["ã‚³ã‚¢ãƒ©", "koala"], c: "animals" },
            { e: "ğŸ¯", k: ["ãƒˆãƒ©", "tiger"], c: "animals" },
            { e: "ğŸ¦", k: ["ãƒ©ã‚¤ã‚ªãƒ³", "lion"], c: "animals" },
            { e: "ğŸ®", k: ["ç‰›", "cow"], c: "animals" },
            { e: "ğŸ·", k: ["è±š", "pig"], c: "animals" },
            { e: "ğŸ¸", k: ["ã‚«ã‚¨ãƒ«", "frog"], c: "animals" },
            { e: "ğŸµ", k: ["çŒ¿", "monkey"], c: "animals" },
            { e: "ğŸ”", k: ["ãƒ‹ãƒ¯ãƒˆãƒª", "chicken"], c: "animals" },
            { e: "ğŸ§", k: ["ãƒšãƒ³ã‚®ãƒ³", "penguin"], c: "animals" },
            { e: "ğŸ¦", k: ["é³¥", "bird"], c: "animals" },
            { e: "ğŸ¤", k: ["ã²ã‚ˆã“", "chick"], c: "animals" },
            { e: "ğŸ¦‹", k: ["è¶", "butterfly"], c: "animals" },
            { e: "ğŸ", k: ["èœ‚", "bee"], c: "animals" },
            { e: "ğŸ", k: ["ã¦ã‚“ã¨ã†è™«", "ladybug"], c: "animals" },
            { e: "ğŸ™", k: ["ã‚¿ã‚³", "octopus"], c: "animals" },
            { e: "ğŸ ", k: ["é­š", "fish"], c: "animals" },
            { e: "ğŸ¬", k: ["ã‚¤ãƒ«ã‚«", "dolphin"], c: "animals" },
            { e: "ğŸ³", k: ["ã‚¯ã‚¸ãƒ©", "whale"], c: "animals" },
            { e: "ğŸ¦ˆ", k: ["ã‚µãƒ¡", "shark"], c: "animals" },
            { e: "ğŸŒ¸", k: ["æ¡œ", "cherry blossom", "flower"], c: "animals" },
            { e: "ğŸ’®", k: ["ã¯ãªã¾ã‚‹", "flower"], c: "animals" },
            { e: "ğŸŒ¹", k: ["ãƒãƒ©", "rose"], c: "animals" },
            { e: "ğŸŒ»", k: ["ã²ã¾ã‚ã‚Š", "sunflower"], c: "animals" },
            { e: "ğŸŒ¼", k: ["èŠ±", "blossom"], c: "animals" },
            { e: "ğŸŒ·", k: ["ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—", "tulip"], c: "animals" },
            { e: "ğŸŒ±", k: ["èŠ½", "seedling"], c: "animals" },
            { e: "ğŸª´", k: ["è¦³è‘‰æ¤ç‰©", "potted plant"], c: "animals" },
            { e: "ğŸŒ²", k: ["æœ¨", "tree"], c: "animals" },
            { e: "ğŸŒ³", k: ["æœ¨", "tree"], c: "animals" },
            { e: "ğŸŒ´", k: ["ãƒ¤ã‚·ã®æœ¨", "palm tree"], c: "animals" },
            { e: "ğŸ", k: ["ç´…è‘‰", "ã‚‚ã¿ã˜", "maple", "leaf"], c: "animals" },
            { e: "ğŸ‚", k: ["è½ã¡è‘‰", "fallen leaf"], c: "animals" },
            { e: "ğŸ€", k: ["ã‚¯ãƒ­ãƒ¼ãƒãƒ¼", "clover"], c: "animals" },
            { e: "ğŸ„", k: ["ã‚­ãƒã‚³", "mushroom"], c: "animals" },
            { e: "ğŸŒˆ", k: ["è™¹", "rainbow"], c: "animals" },
            { e: "â˜€ï¸", k: ["å¤ªé™½", "æ™´ã‚Œ", "sun"], c: "animals" },
            { e: "ğŸŒ™", k: ["æœˆ", "moon"], c: "animals" },
            { e: "â­ï¸", k: ["æ˜Ÿ", "star"], c: "animals" },
            { e: "â„ï¸", k: ["é›ª", "snow"], c: "animals" },
            { e: "â˜ï¸", k: ["é›²", "ãã‚‚ã‚Š", "cloud"], c: "animals" },
            { e: "ğŸŒŠ", k: ["æ³¢", "wave"], c: "animals" },

            // æ—…è¡Œãƒ»å ´æ‰€ (Travel & Places)
            { e: "ğŸš—", k: ["è»Š", "car"], c: "travel" },
            { e: "ğŸš•", k: ["ã‚¿ã‚¯ã‚·ãƒ¼", "taxi"], c: "travel" },
            { e: "ğŸšŒ", k: ["ãƒã‚¹", "bus"], c: "travel" },
            { e: "ğŸš‘", k: ["æ•‘æ€¥è»Š", "ambulance"], c: "travel" },
            { e: "ğŸš“", k: ["ãƒ‘ãƒˆã‚«ãƒ¼", "police car"], c: "travel" },
            { e: "ğŸšƒ", k: ["é›»è»Š", "train"], c: "travel" },
            { e: "ğŸš…", k: ["æ–°å¹¹ç·š", "bullet train"], c: "travel" },
            { e: "âœˆï¸", k: ["é£›è¡Œæ©Ÿ", "airplane", "plane"], c: "travel" },
            { e: "ğŸš€", k: ["ãƒ­ã‚±ãƒƒãƒˆ", "rocket"], c: "travel" },
            { e: "ğŸš¢", k: ["èˆ¹", "ship"], c: "travel" },
            { e: "ğŸš²", k: ["è‡ªè»¢è»Š", "bicycle"], c: "travel" },
            { e: "ğŸ›µ", k: ["ã‚¹ã‚¯ãƒ¼ã‚¿ãƒ¼", "scooter"], c: "travel" },
            { e: "ğŸ ", k: ["å®¶", "house"], c: "travel" },
            { e: "ğŸ¡", k: ["å®¶", "house with garden"], c: "travel" },
            { e: "ğŸ¢", k: ["ãƒ“ãƒ«", "office"], c: "travel" },
            { e: "ğŸ¥", k: ["ç—…é™¢", "hospital"], c: "travel" },
            { e: "ğŸª", k: ["ã‚³ãƒ³ãƒ“ãƒ‹", "convenience store"], c: "travel" },
            { e: "ğŸ«", k: ["å­¦æ ¡", "school"], c: "travel" },
            { e: "ğŸ—¼", k: ["æ±äº¬ã‚¿ãƒ¯ãƒ¼", "tokyo tower"], c: "travel" },
            { e: "ğŸ—½", k: ["è‡ªç”±ã®å¥³ç¥", "statue of liberty"], c: "travel" },
            { e: "ğŸ°", k: ["åŸ", "castle"], c: "travel" },
            { e: "ğŸ¯", k: ["åŸ", "japanese castle"], c: "travel" },
            { e: "â›©ï¸", k: ["é³¥å±…", "shrine"], c: "travel" },
            { e: "ğŸ—»", k: ["å¯Œå£«å±±", "fuji", "mountain"], c: "travel" },
            { e: "ğŸ–ï¸", k: ["ãƒ“ãƒ¼ãƒ", "beach"], c: "travel" },
            { e: "ğŸï¸", k: ["å³¶", "island"], c: "travel" },
            { e: "ğŸï¸", k: ["å…¬åœ’", "park"], c: "travel" },
            { e: "â›ºï¸", k: ["ãƒ†ãƒ³ãƒˆ", "tent"], c: "travel" },
            { e: "â™¨ï¸", k: ["æ¸©æ³‰", "hot springs"], c: "travel" },
            { e: "ğŸŒ", k: ["åœ°çƒ", "earth", "world"], c: "travel" },

            // é£Ÿã¹ç‰© (Food)
            { e: "ğŸ”", k: ["ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼", "burger"], c: "food" },
            { e: "ğŸŸ", k: ["ãƒãƒ†ãƒˆ", "fries"], c: "food" },
            { e: "ğŸ•", k: ["ãƒ”ã‚¶", "pizza"], c: "food" },
            { e: "ğŸ£", k: ["å¯¿å¸", "sushi"], c: "food" },
            { e: "ğŸ™", k: ["ãŠã«ãã‚Š", "rice ball"], c: "food" },
            { e: "ğŸœ", k: ["ãƒ©ãƒ¼ãƒ¡ãƒ³", "ramen", "noodle"], c: "food" },
            { e: "ğŸ›", k: ["ã‚«ãƒ¬ãƒ¼", "curry"], c: "food" },
            { e: "ğŸ", k: ["ãƒ‘ã‚¹ã‚¿", "spaghetti"], c: "food" },
            { e: "ğŸ°", k: ["ã‚±ãƒ¼ã‚­", "cake"], c: "food" },
            { e: "ğŸ‚", k: ["èª•ç”Ÿæ—¥ã‚±ãƒ¼ã‚­", "birthday cake"], c: "food" },
            { e: "ğŸ§", k: ["ã‚«ãƒƒãƒ—ã‚±ãƒ¼ã‚­", "cupcake"], c: "food" },
            { e: "ğŸ©", k: ["ãƒ‰ãƒ¼ãƒŠãƒ„", "donut"], c: "food" },
            { e: "ğŸª", k: ["ã‚¯ãƒƒã‚­ãƒ¼", "cookie"], c: "food" },
            { e: "ğŸ«", k: ["ãƒãƒ§ã‚³", "chocolate"], c: "food" },
            { e: "ğŸ¬", k: ["é£´", "candy"], c: "food" },
            { e: "ğŸ­", k: ["ãƒ­ãƒªãƒãƒƒãƒ—", "lollipop"], c: "food" },
            { e: "ğŸ®", k: ["ãƒ—ãƒªãƒ³", "pudding"], c: "food" },
            { e: "ğŸ¦", k: ["ã‚¢ã‚¤ã‚¹", "ice cream"], c: "food" },
            { e: "ğŸ§", k: ["ã‹ãæ°·", "shaved ice"], c: "food" },
            { e: "ğŸ¿", k: ["ãƒãƒƒãƒ—ã‚³ãƒ¼ãƒ³", "popcorn"], c: "food" },
            { e: "ğŸ¥", k: ["ã‚¯ãƒ­ãƒ¯ãƒƒã‚µãƒ³", "croissant"], c: "food" },
            { e: "ğŸ", k: ["ãƒ‘ãƒ³", "bread"], c: "food" },
            { e: "ğŸ¥", k: ["ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­", "pancakes"], c: "food" },
            { e: "ğŸ³", k: ["ç›®ç‰ç„¼ã", "egg"], c: "food" },
            { e: "ğŸ“", k: ["ã„ã¡ã”", "strawberry"], c: "food" },
            { e: "ğŸ", k: ["ã‚Šã‚“ã”", "apple"], c: "food" },
            { e: "ğŸ‰", k: ["ã‚¹ã‚¤ã‚«", "watermelon"], c: "food" },
            { e: "ğŸŒ", k: ["ãƒãƒŠãƒŠ", "banana"], c: "food" },
            { e: "ğŸ", k: ["ãƒ‘ã‚¤ãƒŠãƒƒãƒ—ãƒ«", "pineapple"], c: "food" },
            { e: "ğŸ‘", k: ["æ¡ƒ", "peach"], c: "food" },
            { e: "ğŸ’", k: ["ã•ãã‚‰ã‚“ã¼", "cherry"], c: "food" },
            { e: "ğŸ‡", k: ["ã¶ã©ã†", "grape"], c: "food" },
            { e: "ğŸµ", k: ["ãŠèŒ¶", "tea"], c: "food" },
            { e: "â˜•ï¸", k: ["ã‚³ãƒ¼ãƒ’ãƒ¼", "coffee"], c: "food" },
            { e: "ğŸ¶", k: ["é…’", "sake"], c: "food" },
            { e: "ğŸº", k: ["ãƒ“ãƒ¼ãƒ«", "beer"], c: "food" },
            { e: "ğŸ»", k: ["ä¹¾æ¯", "cheers"], c: "food" },
            { e: "ğŸ¥‚", k: ["ä¹¾æ¯", "clinking glasses"], c: "food" },
            { e: "ğŸ·", k: ["ãƒ¯ã‚¤ãƒ³", "wine"], c: "food" },
            { e: "ğŸ¹", k: ["ã‚«ã‚¯ãƒ†ãƒ«", "cocktail"], c: "food" },

            // ãƒ¢ãƒ (Objects)
            { e: "ğŸ‰", k: ["ãƒ‘ãƒ¼ãƒ†ã‚£", "ãŠç¥ã„", "party", "popper"], c: "objects" },
            { e: "ğŸŠ", k: ["ãã™ç‰", "confetti ball"], c: "objects" },
            { e: "ğŸ¥³", k: ["ãƒ‘ãƒ¼ãƒ†ã‚£é¡”", "party face"], c: "objects" },
            { e: "ğŸˆ", k: ["é¢¨èˆ¹", "balloon"], c: "objects" },
            { e: "ğŸ", k: ["ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ", "gift"], c: "objects" },
            { e: "ğŸ€", k: ["ãƒªãƒœãƒ³", "ribbon"], c: "objects" },
            { e: "ğŸ¯", k: ["ãƒ€ãƒ¼ãƒ„", "target", "darts"], c: "objects" },
            { e: "ğŸ®", k: ["ã‚²ãƒ¼ãƒ ", "game"], c: "objects" },
            { e: "ğŸ§©", k: ["ãƒ‘ã‚ºãƒ«", "puzzle"], c: "objects" },
            { e: "ğŸ²", k: ["ã‚µã‚¤ã‚³ãƒ­", "dice"], c: "objects" },
            { e: "ğŸ³", k: ["ãƒœãƒ¼ãƒªãƒ³ã‚°", "bowling"], c: "objects" },
            { e: "âš½ï¸", k: ["ã‚µãƒƒã‚«ãƒ¼", "soccer"], c: "objects" },
            { e: "ğŸ€", k: ["ãƒã‚¹ã‚±", "basketball"], c: "objects" },
            { e: "âš¾ï¸", k: ["é‡çƒ", "baseball"], c: "objects" },
            { e: "ğŸ¾", k: ["ãƒ†ãƒ‹ã‚¹", "tennis"], c: "objects" },
            { e: "ğŸ", k: ["ãƒãƒ¬ãƒ¼", "volleyball"], c: "objects" },
            { e: "ğŸŠ", k: ["æ°´æ³³", "swimming"], c: "objects" },
            { e: "ğŸ„", k: ["ã‚µãƒ¼ãƒ•ã‚£ãƒ³", "surfing"], c: "objects" },
            { e: "ğŸ‚", k: ["ã‚¹ãƒãƒœ", "snowboard"], c: "objects" },
            { e: "ğŸ¿", k: ["ã‚¹ã‚­ãƒ¼", "ski"], c: "objects" },
            { e: "ğŸ£", k: ["é‡£ã‚Š", "fishing"], c: "objects" },
            { e: "ğŸ•ï¸", k: ["ã‚­ãƒ£ãƒ³ãƒ—", "camping"], c: "objects" },
            { e: "ğŸ¬", k: ["æ˜ ç”»", "movie", "clapper"], c: "objects" },
            { e: "ğŸ¤", k: ["ãƒã‚¤ã‚¯", "mic", "karaoke"], c: "objects" },
            { e: "ğŸ§", k: ["ãƒ˜ãƒƒãƒ‰ãƒ›ãƒ³", "music"], c: "objects" },
            { e: "ğŸ¼", k: ["æ¥½è­œ", "music"], c: "objects" },
            { e: "ğŸ¹", k: ["ãƒ”ã‚¢ãƒ", "piano"], c: "objects" },
            { e: "ğŸ¸", k: ["ã‚®ã‚¿ãƒ¼", "guitar"], c: "objects" },
            { e: "ğŸ¨", k: ["ã‚¢ãƒ¼ãƒˆ", "art", "palette"], c: "objects" },
            { e: "ğŸ†", k: ["ãƒˆãƒ­ãƒ•ã‚£ãƒ¼", "trophy"], c: "objects" },
            { e: "ğŸ’»", k: ["PC", "computer", "laptop"], c: "objects" },
            { e: "ğŸ“±", k: ["ã‚¹ãƒãƒ›", "mobile", "phone"], c: "objects" },
            { e: "ğŸ’¡", k: ["ã‚¢ã‚¤ãƒ‡ã‚¢", "é›»çƒ", "idea", "bulb"], c: "objects" },
            { e: "ğŸ’°", k: ["ãŠé‡‘", "money", "bag"], c: "objects" },
            { e: "ğŸ’", k: ["ãƒ€ã‚¤ãƒ¤", "diamond"], c: "objects" },
            { e: "ğŸ‘‘", k: ["ç‹å† ", "crown"], c: "objects" },
            { e: "ğŸ’", k: ["æŒ‡è¼ª", "ring"], c: "objects" },
            { e: "ğŸ’„", k: ["å£ç´…", "lipstick"], c: "objects" },
            { e: "ğŸ“š", k: ["æœ¬", "book", "study"], c: "objects" },
            { e: "âœï¸", k: ["é‰›ç­†", "pencil"], c: "objects" },
            { e: "ğŸ“", k: ["ãƒ¡ãƒ¢", "memo"], c: "objects" },
            { e: "ğŸ“…", k: ["ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼", "calendar"], c: "objects" },
            { e: "ğŸ—“ï¸", k: ["ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼", "calendar"], c: "objects" },
            { e: "ğŸ•°ï¸", k: ["æ™‚è¨ˆ", "clock"], c: "objects" },
            { e: "â°", k: ["ç›®è¦šã¾ã—", "alarm"], c: "objects" },
            { e: "â³", k: ["ç ‚æ™‚è¨ˆ", "hourglass"], c: "objects" },
            { e: "ğŸ”‘", k: ["ã‚­ãƒ¼", "key"], c: "objects" },
            { e: "ğŸ”’", k: ["éµ", "lock", "secure"], c: "objects" },
            { e: "ğŸ”“", k: ["é–‹éŒ ", "unlock"], c: "objects" },
            { e: "ğŸ”¨", k: ["ãƒãƒ³ãƒãƒ¼", "hammer"], c: "objects" },
            { e: "ğŸ”§", k: ["ãƒ¬ãƒ³ãƒ", "wrench", "tool"], c: "objects" },
            { e: "âš™ï¸", k: ["æ­¯è»Š", "gear", "settings"], c: "objects" },
            { e: "ğŸª„", k: ["é­”æ³•ã®æ–", "magic wand"], c: "objects" },
            { e: "ğŸ’Š", k: ["è–¬", "pill"], c: "objects" },
            { e: "ğŸ’‰", k: ["æ³¨å°„", "syringe"], c: "objects" },
            { e: "ğŸ©¹", k: ["çµ†å‰µè†", "bandage"], c: "objects" },
            { e: "ğŸ’Œ", k: ["ãƒ©ãƒ–ãƒ¬ã‚¿ãƒ¼", "love letter"], c: "objects" },
            { e: "ğŸ“¦", k: ["ç®±", "package"], c: "objects" },
            { e: "ğŸ“º", k: ["ãƒ†ãƒ¬ãƒ“", "tv"], c: "objects" },
            { e: "ğŸ“¸", k: ["ã‚«ãƒ¡ãƒ©", "camera"], c: "objects" },

            // è¨˜å· (Symbols)
            { e: "â¤ï¸", k: ["ãƒãƒ¼ãƒˆ", "èµ¤", "heart", "love"], c: "symbols" },
            { e: "ğŸ§¡", k: ["ãƒãƒ¼ãƒˆ", "ã‚ªãƒ¬ãƒ³ã‚¸", "orange heart"], c: "symbols" },
            { e: "ğŸ’›", k: ["ãƒãƒ¼ãƒˆ", "é»„", "yellow heart"], c: "symbols" },
            { e: "ğŸ’š", k: ["ãƒãƒ¼ãƒˆ", "ç·‘", "green heart"], c: "symbols" },
            { e: "ğŸ’™", k: ["ãƒãƒ¼ãƒˆ", "é’", "blue heart"], c: "symbols" },
            { e: "ğŸ’œ", k: ["ãƒãƒ¼ãƒˆ", "ç´«", "purple heart"], c: "symbols" },
            { e: "ğŸ–¤", k: ["ãƒãƒ¼ãƒˆ", "é»’", "black heart"], c: "symbols" },
            { e: "ğŸ¤", k: ["ãƒãƒ¼ãƒˆ", "ç™½", "white heart"], c: "symbols" },
            { e: "ğŸ¤", k: ["ãƒãƒ¼ãƒˆ", "èŒ¶", "brown heart"], c: "symbols" },
            { e: "ğŸ’”", k: ["å¤±æ‹", "broken heart"], c: "symbols" },
            { e: "â¤ï¸â€ğŸ”¥", k: ["ç‡ƒãˆã‚‹ãƒãƒ¼ãƒˆ", "heart on fire"], c: "symbols" },
            { e: "â¤ï¸â€ğŸ©¹", k: ["çµ†å‰µè†ãƒãƒ¼ãƒˆ", "mending heart"], c: "symbols" },
            { e: "â£ï¸", k: ["æ„Ÿå˜†ç¬¦ãƒãƒ¼ãƒˆ", "heart exclamation"], c: "symbols" },
            { e: "ğŸ’•", k: ["2 ã¤ã®ãƒãƒ¼ãƒˆ", "two hearts"], c: "symbols" },
            { e: "ğŸ’", k: ["å›ã‚‹ãƒãƒ¼ãƒˆ", "revolving hearts"], c: "symbols" },
            { e: "ğŸ’“", k: ["é¼“å‹•", "beating heart"], c: "symbols" },
            { e: "ğŸ’—", k: ["æˆé•·", "growing heart"], c: "symbols" },
            { e: "ğŸ’–", k: ["ã‚­ãƒ©ã‚­ãƒ©ãƒãƒ¼ãƒˆ", "sparkling heart"], c: "symbols" },
            { e: "ğŸ’˜", k: ["çŸ¢", "heart with arrow"], c: "symbols" },
            { e: "ğŸ’", k: ["ãƒªãƒœãƒ³ãƒãƒ¼ãƒˆ", "heart with ribbon"], c: "symbols" },
            { e: "ğŸ’Ÿ", k: ["ãƒãƒ¼ãƒˆ", "heart decoration"], c: "symbols" },
            { e: "ğŸ”¥", k: ["ç«", "fire", "hot"], c: "symbols" },
            { e: "âœ¨", k: ["ã‚­ãƒ©ã‚­ãƒ©", "sparkles"], c: "symbols" },
            { e: "ğŸŒŸ", k: ["è¼ãæ˜Ÿ", "glowing star"], c: "symbols" },
            { e: "ğŸ’«", k: ["ã‚ã¾ã„", "dizzy", "star"], c: "symbols" },
            { e: "ğŸ’¥", k: ["çˆ†ç™º", "collision", "boom"], c: "symbols" },
            { e: "ğŸ’¨", k: ["ãƒ€ãƒƒã‚·ãƒ¥", "dash"], c: "symbols" },
            { e: "ğŸ’¦", k: ["æ±—", "sweat", "drops"], c: "symbols" },
            { e: "ğŸ’¤", k: ["çœ ã‚Š", "zzz", "sleep"], c: "symbols" },
            { e: "ğŸ’¯", k: ["100 ç‚¹", "100", "perfect"], c: "symbols" },
            { e: "â­•ï¸", k: ["ä¸¸", "ã¾ã‚‹", "ok", "circle"], c: "symbols" },
            { e: "âŒ", k: ["ãƒãƒ„", "ã°ã¤", "no", "cross"], c: "symbols" },
            { e: "â“", k: ["ï¼Ÿ", "ã¯ã¦ãª", "question"], c: "symbols" },
            { e: "â—ï¸", k: ["ï¼", "ã³ã£ãã‚Š", "exclamation"], c: "symbols" },
            { e: "âœ…", k: ["ãƒã‚§ãƒƒã‚¯", "check", "mark"], c: "symbols" },
            { e: "â", k: ["ãƒã‚§ãƒƒã‚¯", "cross mark"], c: "symbols" },
            { e: "âš ï¸", k: ["è­¦å‘Š", "warning"], c: "symbols" },
            { e: "â¡ï¸", k: ["çŸ¢å°", "å³", "arrow", "right"], c: "symbols" },
            { e: "â¬†ï¸", k: ["çŸ¢å°", "ä¸Š", "arrow", "up"], c: "symbols" },
            { e: "â¬‡ï¸", k: ["çŸ¢å°", "ä¸‹", "arrow", "down"], c: "symbols" },
        ];

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹
        const state = {
            links: [], // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿
            originalLinks: [], // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ç”¨ã«ä¿æŒã™ã‚‹å…ƒã®ãƒ‡ãƒ¼ã‚¿
            editMode: false,
            sortableInstance: null,
            defaultColor: '#06b6d4', // Cyan-600
            currentEmojiInput: null, // çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ãŒå¯¾è±¡ã¨ã™ã‚‹å…¥åŠ›æ¬„
            currentEmojiCategory: 'smileys', // çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ã®ç¾åœ¨ã‚«ãƒ†ã‚´ãƒª
        };

        // DOM è¦ç´ 
        const $ = {
            linksContainer: document.getElementById('links-container'),
            loadingSpinner: document.getElementById('loading-spinner'),
            emptyState: document.getElementById('empty-state'),
            toggleEditModeBtn: document.getElementById('toggle-edit-mode'),
            toggleEditText: document.getElementById('toggle-edit-text'),
            iconSettings: document.getElementById('icon-settings'),
            iconClose: document.getElementById('icon-close'),
            editControls: document.getElementById('edit-controls'), // ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆãƒ’ãƒ³ãƒˆç”¨ï¼‰
            addCardContainer: document.getElementById('add-card-container'), // æ–°è¦è¿½åŠ ãƒœã‚¿ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠ
            addNewCardBtn: document.getElementById('add-new-card-btn'), // æ–°è¦è¿½åŠ ãƒœã‚¿ãƒ³
            editModeActions: document.getElementById('edit-mode-actions'), // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¿å­˜/ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚³ãƒ³ãƒ†ãƒŠ
            saveChangesBtn: document.getElementById('save-changes'), // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¿å­˜ãƒœã‚¿ãƒ³
            cancelChangesBtn: document.getElementById('cancel-changes'), // ãƒ˜ãƒƒãƒ€ãƒ¼ã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒœã‚¿ãƒ³
            toastContainer: document.getElementById('toast-container'),
            // çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼
            emojiPickerModal: document.getElementById('emoji-picker-modal'),
            emojiPickerContent: document.getElementById('emoji-picker-content'),
            emojiSearchInput: document.getElementById('emoji-search-input'),
            emojiPickerTabs: document.getElementById('emoji-picker-tabs'), // ã‚¿ãƒ–
            emojiPickerGrid: document.getElementById('emoji-picker-grid'),
        };

        // --- API é€šä¿¡ ---

        async function fetchLinks() {
            try {
                const response = await fetch('/api/links');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();

                state.links = data || [];
                state.originalLinks = JSON.parse(JSON.stringify(state.links));
            } catch (error) {
                console.error(error);
                showToast('ãƒªãƒ³ã‚¯ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                state.links = [];
                state.originalLinks = [];
            }
        }

        async function postLinks(linksToSave) {
            try {
                const response = await fetch('/api/links', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(linksToSave),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const savedData = await response.json();

                state.links = savedData || [];
                state.originalLinks = JSON.parse(JSON.stringify(state.links));
                showToast('å¤‰æ›´ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
                return true;
            } catch (error) {
                console.error(error);
                showToast('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                return false;
            }
        }

        // --- ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° ---

        function render() {
            $.linksContainer.innerHTML = '';

            if (state.links.length === 0 && !state.editMode) {
                $.emptyState.classList.remove('hidden');
                $.loadingSpinner.classList.add('hidden');
            } else {
                 $.emptyState.classList.add('hidden');
                 $.loadingSpinner.classList.add('hidden');
            }

            state.links.forEach(link => {
                const card = createLinkCard(link);
                $.linksContainer.appendChild(card);
            });

            setupLinkCardEventListeners();
            setupSortable();
        }

        function createLinkCard(link) {
            const div = document.createElement('div');
            const color = link.color || state.defaultColor;

            // è‰²ã®æ˜åº¦ã«å¿œã˜ã¦æ–‡å­—è‰²ã‚’èª¿æ•´ã™ã‚‹é–¢æ•°
            // æ·¡ã„è‰²â†’æ¿ƒã„æ–‡å­—ã€æ¿ƒã„è‰²â†’é©åº¦ãªæ˜åº¦ã®æ–‡å­—
            function getTextColorForColor(colorHex) {
                const hex = colorHex.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);
                // æ˜åº¦ã‚’è¨ˆç®—
                const brightness = (r * 299 + g * 587 + b * 114) / 1000;

                // æ˜åº¦ã«å¿œã˜ã¦æ–‡å­—è‰²ã‚’èª¿æ•´
                // æ˜åº¦ãŒé«˜ã„ï¼ˆæ·¡ã„è‰²ï¼‰â†’ æ¿ƒã„é»’ï¼ˆ#1f2937 / gray-800ï¼‰
                // æ˜åº¦ãŒä½ã„ï¼ˆæ¿ƒã„è‰²ï¼‰â†’ é©åº¦ãªæ˜åº¦ã®ã‚°ãƒ¬ãƒ¼ï¼ˆ#4b5563 / gray-600ï¼‰
                if (brightness > 180) {
                    return '#1f2937'; // gray-800ï¼ˆæ¿ƒã„é»’ï¼‰
                } else if (brightness > 100) {
                    return '#374151'; // gray-700ï¼ˆä¸­æ¿ƒï¼‰
                } else {
                    return '#4b5563'; // gray-600ï¼ˆä¸­è–„ï¼‰
                }
            }

            // è‰²ã®æ˜åº¦ã«å¿œã˜ã¦ã‚¿ã‚¤ãƒˆãƒ«æ–‡å­—è‰²ã‚’èª¿æ•´ã™ã‚‹é–¢æ•°
            // æ·¡ã„è‰²ã¯èª¿æ•´ã€æ¿ƒã„è‰²ã¯å…ƒã®è‰²ã‚’ä½¿ç”¨
            function getTitleColorForCardColor(colorHex) {
                const hex = colorHex.replace('#', '');
                const r = parseInt(hex.substr(0, 2), 16);
                const g = parseInt(hex.substr(2, 2), 16);
                const b = parseInt(hex.substr(4, 2), 16);
                // æ˜åº¦ã‚’è¨ˆç®—
                const brightness = (r * 299 + g * 587 + b * 114) / 1000;

                // æ·¡ã„è‰²ï¼ˆæ˜åº¦ãŒé«˜ã„ï¼‰ã®ã¿èª¿æ•´ã€æ¿ƒã„è‰²ã¯å…ƒã®è‰²ã‚’ä½¿ç”¨
                // é–¾å€¤ã‚’ 150 ã«ä¸‹ã’ã¦ã€ã‚ˆã‚Šå¤šãã®è‰²ã‚’æ¿ƒã„æ–‡å­—è‰²ã«ã™ã‚‹
                if (brightness > 150) {
                    return '#374151'; // gray-700ï¼ˆä¸­æ¿ƒï¼‰
                }
                // æ¿ƒã„è‰²ã¯å…ƒã®è‰²ã‚’ãã®ã¾ã¾ä½¿ç”¨
                return colorHex;
            }

            div.className = `link-card bg-white/80 dark:bg-slate-800/80 glass-panel rounded-xl shadow-md border border-gray-200/50 dark:border-slate-700/50 transition-all duration-300 border-l-4 ${state.editMode ? 'shadow-lg' : ''}`;
            div.style.borderColor = color;
            div.dataset.id = link.id;

            // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ UI
            const editModeUI = `
                <div class="p-5">
                    <div class="drag-handle absolute top-3 right-3 p-1.5 text-gray-400 dark:text-gray-500 cursor-move hover:text-cyan-500 transition-color rounded-lg" title="ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ä¸¦ã³æ›¿ãˆ">
                        ${icons.handle}
                    </div>

                    <div class="space-y-4">
                        <div class="flex gap-4 items-start">
                            <!-- è‰² -->
                            <div class="flex-shrink-0">
                                <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5 mono-font">COLOR</label>
                                <input type="color" value="${escapeHTML(color)}" data-field="color" class="edit-input" title="ã‚«ãƒ©ãƒ¼ãƒ”ãƒƒã‚«ãƒ¼">
                            </div>
                            <!-- çµµæ–‡å­— -->
                            <div class="flex-shrink-0 w-16">
                                <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5 mono-font">EMOJI</label>
                                <input type="text" value="${escapeHTML(link.emoji || '')}" data-field="emoji" class="edit-input emoji-input mt-0.5 block w-full text-xl text-center rounded-lg border-gray-300 dark:border-slate-600 shadow-sm focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 bg-white/50 dark:bg-slate-700/50 py-2 px-3 cursor-pointer" maxlength="4" readonly>
                            </div>
                            <!-- åå‰ -->
                            <div class="flex-grow min-w-0">
                                <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5 mono-font">NAME</label>
                                <input type="text" value="${escapeHTML(link.name)}" data-field="name" class="edit-input mt-0.5 block w-full font-semibold rounded-lg border-gray-300 dark:border-slate-600 shadow-sm focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 bg-white/50 dark:bg-slate-700/50 py-2 px-3">
                            </div>
                        </div>

                        <!-- URL -->
                        <div>
                            <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5 mono-font">URL</label>
                            <input type="text" value="${escapeHTML(link.url)}" data-field="url" class="edit-input mt-0.5 block w-full text-sm rounded-lg border-gray-300 dark:border-slate-600 shadow-sm focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 bg-white/50 dark:bg-slate-700/50 py-2 px-3 mono-font">
                        </div>

                        <!-- èª¬æ˜ -->
                        <div>
                            <label class="block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5 mono-font">DESCRIPTION</label>
                            <textarea data-field="description" class="edit-input mt-0.5 block w-full text-sm rounded-lg border-gray-300 dark:border-slate-600 shadow-sm focus:border-cyan-500 focus:ring-2 focus:ring-cyan-200 bg-white/50 dark:bg-slate-700/50" rows="2" placeholder="ã“ã®ãƒªãƒ³ã‚¯ã®ç°¡å˜ãªèª¬æ˜ï¼ˆç·¨é›†ä¸­ã®ã¿è¡¨ç¤ºï¼‰">${escapeHTML(link.description || '')}</textarea>
                        </div>
                    </div>

                    <div class="flex justify-end gap-2 mt-4 pt-4 border-t border-gray-100 dark:border-slate-700/50">
                        <button class="btn-delete p-2.5 rounded-lg text-gray-500 dark:text-gray-400 hover:bg-red-50 dark:hover:bg-red-900/30 hover:text-red-600 dark:hover:text-red-400 transition-colors" title="å‰Šé™¤">
                            ${icons.delete}
                        </button>
                    </div>
                </div>
            `;

            // è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ UI
            const textColor = '#374151'; // å¸¸ã«é»’ç³»ï¼ˆgray-700ï¼‰
            const titleColor = getTitleColorForCardColor(color);
            const emojiHTML = link.emoji ? `<span class="text-3xl mr-3">${escapeHTML(link.emoji)}</span>` : '';
            const viewModeUI = `
                <a href="${escapeHTML(link.url)}" target="_blank" rel="noopener noreferrer" class="block p-6 h-full group">
                    <div class="flex items-center mb-2">
                        ${emojiHTML}
                        <h3 class="text-xl font-bold truncate" style="color: ${titleColor}">
                            ${escapeHTML(link.name)}
                        </h3>
                    </div>
                    <p class="text-xs mono-font truncate ${link.emoji ? 'ml-12' : ''}" style="color: ${textColor}">
                        ${escapeHTML(link.url)}
                    </p>
                </a>
                <div class="absolute bottom-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity">
                    <button class="btn-copy p-2.5 rounded-lg text-gray-400 dark:text-gray-500 hover:bg-cyan-100 dark:hover:bg-cyan-900/40 hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors" title="ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼">
                        ${icons.copy}
                    </button>
                </div>
            `;

            div.innerHTML = `
                <div class="relative h-full">
                    ${state.editMode ? editModeUI : viewModeUI}
                </div>
            `;
            return div;
        }

        // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š ---

        function setupLinkCardEventListeners() {
            document.querySelectorAll('.link-card').forEach(card => {
                const id = card.dataset.id;

                if (state.editMode) {
                    // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã®ã‚¤ãƒ™ãƒ³ãƒˆ
                    const inputs = card.querySelectorAll('.edit-input');
                    inputs.forEach(input => {
                        if (input.classList.contains('emoji-input')) {
                            input.addEventListener('focus', (e) => {
                                openEmojiPicker(e.target);
                            });
                        } else {
                            // ãã®ä»–ã®å…¥åŠ›æ¬„
                            input.addEventListener('input', (e) => {
                                const field = e.target.dataset.field;
                                const link = state.links.find(l => l.id === id);
                                if (link) {
                                    link[field] = e.target.value;
                                    if (field === 'color') {
                                        card.style.borderColor = e.target.value;
                                    }
                                }
                            });
                        }
                    });

                    const deleteBtn = card.querySelector('.btn-delete');
                    deleteBtn?.addEventListener('click', () => handleDeleteLink(id));

                } else {
                    // è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ã®ã‚¤ãƒ™ãƒ³ãƒˆ
                    const copyBtn = card.querySelector('.btn-copy');
                    copyBtn?.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        handleCopyLink(id, copyBtn);
                    });
                }
            });
        }

        // --- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ³ãƒ‰ãƒ© ---

        function toggleEditMode() {
            state.editMode = !state.editMode;

            $.toggleEditText.textContent = state.editMode ? 'è¨­å®šå®Œäº†' : 'è¨­å®šãƒ¢ãƒ¼ãƒ‰';
            $.iconSettings.classList.toggle('hidden', state.editMode);
            $.iconClose.classList.toggle('hidden', !state.editMode);

            $.editModeActions.classList.toggle('hidden', !state.editMode);
            $.editControls.classList.toggle('hidden', !state.editMode);
            $.addCardContainer.classList.toggle('hidden', !state.editMode);

            if (state.editMode) {
                $.toggleEditModeBtn.classList.remove('from-cyan-600', 'to-teal-600', 'hover:from-cyan-500', 'hover:to-teal-500');
                $.toggleEditModeBtn.classList.add('from-slate-600', 'to-slate-700', 'hover:from-slate-500', 'hover:to-slate-600');
                state.originalLinks = JSON.parse(JSON.stringify(state.links));
            } else {
                $.toggleEditModeBtn.classList.add('from-cyan-600', 'to-teal-600', 'hover:from-cyan-500', 'hover:to-teal-500');
                $.toggleEditModeBtn.classList.remove('from-slate-600', 'to-slate-700', 'hover:from-slate-500', 'hover:to-slate-600');
            }

            render();
        }

        function handleAddNewCard() {
            const newLink = {
                id: 'id-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                name: "æ–°ã—ã„ãƒªãƒ³ã‚¯",
                url: "https://example.com",
                emoji: "âœ¨",
                color: state.defaultColor,
                description: "",
            };

            state.links.unshift(newLink);
            render();

            const newCardElement = document.querySelector(`[data-id="${newLink.id}"]`);
            if (newCardElement) {
                newCardElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            showToast('æ–°ã—ã„ã‚«ãƒ¼ãƒ‰ã‚’ãƒªã‚¹ãƒˆã®å…ˆé ­ã«è¿½åŠ ã—ã¾ã—ãŸ', 'info');
        }


        async function handleSaveChanges() {
            if (state.sortableInstance) {
                const newOrder = state.sortableInstance.toArray();
                const newLinks = newOrder.map(id => state.links.find(link => link.id === id));
                state.links = newLinks.filter(Boolean);
            }

            const success = await postLinks(state.links);
            if (success) {
                toggleEditMode();
            }
        }

        function handleCancelChanges() {
            state.links = JSON.parse(JSON.stringify(state.originalLinks));
            toggleEditMode();
            render();
            showToast('å¤‰æ›´ã¯ç ´æ£„ã•ã‚Œã¾ã—ãŸ', 'info');
        }

        function handleDeleteLink(id) {
            const link = state.links.find(l => l.id === id);
            const confirmed = window.confirm(`ã€Œ${link.emoji || ''} ${link.name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`);
            if (confirmed) {
                state.links = state.links.filter(l => l.id !== id);
                render();
                showToast('ãƒªãƒ³ã‚¯ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚ä¿å­˜ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚', 'info');
            }
        }

        function handleCopyLink(id, button) {
            const link = state.links.find(l => l.id === id);
            if (!link) return;
            const url = link.url;

            const textarea = document.createElement('textarea');
            textarea.value = url;
            textarea.style.position = 'fixed';
            textarea.style.opacity = 0;
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();

            let success = false;
            try {
                success = document.execCommand('copy');
            } catch (err) {
                console.error('Copy failed:', err);
                success = false;
            }

            document.body.removeChild(textarea);

            if (success) {
                showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!', 'success');
                const originalIcon = button.innerHTML;
                button.innerHTML = icons.check;
                setTimeout(() => {
                    button.innerHTML = originalIcon;
                }, 2000);
            } else {
                showToast('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }

        // --- çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼é–¢é€£ ---

        function renderEmojiPicker() {
            $.emojiPickerGrid.innerHTML = '';
            const query = $.emojiSearchInput.value.toLowerCase().trim();

            let filteredEmojis;

            if (query) {
                // æ¤œç´¢æ™‚ï¼šã‚«ãƒ†ã‚´ãƒªã‚’ç„¡è¦–ã—ã¦å…¨ä»¶æ¤œç´¢
                filteredEmojis = emojiPickerData.filter(emoji => {
                    return emoji.e.includes(query) ||
                           emoji.k.some(k => k.toLowerCase().includes(query));
                });
            } else {
                // é€šå¸¸æ™‚ï¼šç¾åœ¨ã®ã‚«ãƒ†ã‚´ãƒªã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
                filteredEmojis = emojiPickerData.filter(emoji => emoji.c === state.currentEmojiCategory);
            }

            if (filteredEmojis.length === 0) {
                $.emojiPickerGrid.innerHTML = `<p class="col-span-7 sm:col-span-8 text-center text-gray-500 dark:text-gray-400 py-8">è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>`;
                return;
            }

            filteredEmojis.forEach(emoji => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'emoji-btn text-2xl p-1.5 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-400 hover:bg-cyan-50 dark:hover:bg-cyan-900/30';
                btn.textContent = emoji.e;
                btn.setAttribute('role', 'gridcell');
                btn.setAttribute('aria-label', emoji.k[0]);
                btn.addEventListener('click', () => {
                    selectEmoji(emoji.e);
                });
                $.emojiPickerGrid.appendChild(btn);
            });
        }

        function renderEmojiTabs() {
            $.emojiPickerTabs.innerHTML = '';
            Object.keys(emojiCategories).forEach(key => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'emoji-tab-btn px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap';
                btn.textContent = emojiCategories[key];
                btn.dataset.category = key;
                btn.setAttribute('role', 'tab');
                btn.setAttribute('aria-selected', state.currentEmojiCategory === key);

                btn.addEventListener('click', () => {
                    state.currentEmojiCategory = key;
                    $.emojiSearchInput.value = '';
                    renderEmojiTabs();
                    renderEmojiPicker();
                });
                $.emojiPickerTabs.appendChild(btn);
            });
        }

        function openEmojiPicker(targetInput) {
            if (!state.editMode) return;
            state.currentEmojiInput = targetInput;
            state.currentEmojiCategory = 'smileys';

            $.emojiSearchInput.value = '';
            renderEmojiTabs();
            renderEmojiPicker();

            $.emojiPickerModal.classList.remove('hidden');
            $.emojiSearchInput.focus();
        }

        function closeEmojiPicker() {
            $.emojiPickerModal.classList.add('hidden');
            if (state.currentEmojiInput) {
                state.currentEmojiInput.blur();
            }
            state.currentEmojiInput = null;
        }

        function selectEmoji(emoji) {
            if (state.currentEmojiInput) {
                state.currentEmojiInput.value = emoji;

                // å¤‰æ›´ã‚’ state ã«å³æ™‚åæ˜ 
                const id = state.currentEmojiInput.closest('.link-card').dataset.id;
                const link = state.links.find(l => l.id === id);
                if (link) {
                    link.emoji = emoji;
                }
            }
            closeEmojiPicker();
        }


        // --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---

        function setupSortable() {
            if (state.editMode) {
                if (state.sortableInstance) {
                    state.sortableInstance.destroy();
                }
                state.sortableInstance = Sortable.create($.linksContainer, {
                    animation: 200,
                    handle: '.drag-handle',
                    ghostClass: 'sortable-ghost',
                    chosenClass: 'sortable-chosen',
                });
            } else {
                if (state.sortableInstance) {
                    state.sortableInstance.destroy();
                    state.sortableInstance = null;
                }
            }
        }

        function showToast(message, type = 'info') {
            const colors = {
                info: 'bg-gradient-to-r from-cyan-600 to-teal-600',
                success: 'bg-gradient-to-r from-green-600 to-emerald-600',
                error: 'bg-gradient-to-r from-red-600 to-rose-600',
            };
            const toast = document.createElement('div');
            toast.className = `toast-message toast-enter text-white px-5 py-3 rounded-xl shadow-lg font-medium ${colors[type]}`;
            toast.textContent = message;

            $.toastContainer.appendChild(toast);

            requestAnimationFrame(() => {
                toast.classList.remove('toast-enter');
            });

            setTimeout(() => {
                toast.classList.add('toast-leave');
                toast.addEventListener('transitionend', () => {
                    toast.remove();
                });
            }, 3000);
        }

        function escapeHTML(str) {
            if (str === null || str === undefined) {
                return '';
            }
            return String(str).replace(/[&<>"']/g, function(match) {
                return {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#39;'
                }[match];
            });
        }

        // --- æ™‚è¨ˆæ©Ÿèƒ½ ---

        function updateDigitalClock() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            const date = now.getMonth() + 1 + '/' + now.getDate();

            const hoursEl = document.getElementById('digital-clock-hours');
            const minutesEl = document.getElementById('digital-clock-minutes');
            const secondsEl = document.getElementById('digital-clock-seconds');
            const dateEl = document.getElementById('digital-date');

            if (hoursEl) hoursEl.textContent = hours;
            if (minutesEl) minutesEl.textContent = minutes;
            if (secondsEl) secondsEl.textContent = seconds;
            if (dateEl) dateEl.textContent = date;
        }

        // --- åˆæœŸåŒ– ---

        async function init() {
            $.toggleEditModeBtn.addEventListener('click', toggleEditMode);
            $.addNewCardBtn.addEventListener('click', handleAddNewCard);
            $.saveChangesBtn.addEventListener('click', handleSaveChanges);
            $.cancelChangesBtn.addEventListener('click', handleCancelChanges);

            // çµµæ–‡å­—ãƒ”ãƒƒã‚«ãƒ¼ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
            $.emojiSearchInput.addEventListener('input', renderEmojiPicker);
            // ãƒ¢ãƒ¼ãƒ€ãƒ«ã®å¤–å´ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰é–‰ã˜ã‚‹
            $.emojiPickerModal.addEventListener('click', (e) => {
                if (e.target === $.emojiPickerModal) {
                    closeEmojiPicker();
                }
            });

            // æ™‚è¨ˆã®åˆæœŸæ›´æ–°ã¨æ¯ç§’æ›´æ–°
            updateDigitalClock();
            setInterval(updateDigitalClock, 1000);

            // ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦åˆå›æç”»
            await fetchLinks();
            render();
        }

        document.addEventListener('DOMContentLoaded', init);

    </script>
</body>
</html>